[{"filePath":"C:\\Users\\Administrator\\Desktop\\my-online-shop\\admin-dashboard\\app\\(dashboard)\\page.tsx","messages":[{"ruleId":"react-hooks/purity","severity":2,"message":"Error: Cannot call impure function during render\n\n`Date.now` is an impure function. Calling an impure function can produce unstable results that update unpredictably when the component happens to re-render. (https://react.dev/reference/rules/components-and-hooks-must-be-pure#components-and-hooks-must-be-idempotent).\n\nC:\\Users\\Administrator\\Desktop\\my-online-shop\\admin-dashboard\\app\\(dashboard)\\page.tsx:17:15\n  15 |\n  16 | export default async function DashboardPage() {\n> 17 |   const now = Date.now();\n     |               ^^^^^^^^^^ Cannot call impure function\n  18 |   const supabase = await createClient();\n  19 |\n  20 |   const [ordersRes, productsRes, customersRes] = await Promise.all([","line":17,"column":15,"nodeType":null,"endLine":17,"endColumn":25}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createClient } from \"@/utils/supabase/server\";\nimport { subDays, format } from \"date-fns\";\nimport DashboardContent, {\n  type DashboardStats,\n  type Alert,\n  type Forecast,\n  type AnalyticsData,\n} from \"@/components/dashboard/DashboardContent\";\nimport type { Database } from \"@/types/supabase\";\n\nexport const dynamic = \"force-dynamic\";\n\ntype Order = Database[\"public\"][\"Tables\"][\"orders\"][\"Row\"];\ntype Product = Database[\"public\"][\"Tables\"][\"products\"][\"Row\"];\n\nexport default async function DashboardPage() {\n  const now = Date.now();\n  const supabase = await createClient();\n\n  const [ordersRes, productsRes, customersRes] = await Promise.all([\n    supabase\n      .from(\"orders\")\n      .select(\n        \"id, status, total_amount, created_at, customer_id, product_name, category, wilaya_address\",\n      )\n      .order(\"created_at\", { ascending: false })\n      .limit(200),\n    supabase\n      .from(\"products\")\n      .select(\"id, name, name_en, stock\")\n      .is(\"deleted_at\", null),\n    supabase.from(\"customers\").select(\"id\", { count: \"exact\", head: true }),\n  ]);\n\n  const orders = (ordersRes.data || []) as Order[];\n  const products = (productsRes.data || []) as Product[];\n  const totalCustomers = customersRes.count || 0;\n\n  // 2. Process Analytics on the Server\n  const revenue = orders\n    .filter((o) => o.status !== \"cancelled\")\n    .reduce((sum, o) => sum + (Number(o.total_amount) || 0), 0);\n\n  const activeOrders = orders.filter((o) =>\n    [\"pending\", \"shipped\"].includes(o.status || \"\"),\n  ).length;\n\n  const lowStockThreshold = 10;\n  const lowStockItems = products.filter(\n    (p) => (Number(p.stock) || 0) <= lowStockThreshold,\n  );\n\n  const sevenDaysAgo = subDays(new Date(), 7);\n  const fourteenDaysAgo = subDays(new Date(), 14);\n  const recentOrders = orders.filter(\n    (o) => o.created_at && new Date(o.created_at) > sevenDaysAgo,\n  );\n  const prevPeriodOrders = orders.filter(\n    (o) =>\n      o.created_at &&\n      new Date(o.created_at) > fourteenDaysAgo &&\n      new Date(o.created_at) <= sevenDaysAgo,\n  );\n  const uniqueCustomers = new Set(\n    recentOrders.map((o) => o.customer_id).filter(Boolean),\n  );\n\n  // Revenue Trends (Last 7 Days)\n  const groupedRevenue = new Map<string, number>();\n  const productSales = new Map<string, number>();\n\n  for (let i = 6; i >= 0; i--) {\n    groupedRevenue.set(format(subDays(new Date(), i), \"MMM dd\"), 0);\n  }\n\n  orders\n    .filter((o) => o.status !== \"cancelled\")\n    .forEach((o) => {\n      if (!o.created_at) return;\n      const dateStr = format(new Date(o.created_at), \"MMM dd\");\n      if (groupedRevenue.has(dateStr)) {\n        groupedRevenue.set(\n          dateStr,\n          (groupedRevenue.get(dateStr) || 0) + (Number(o.total_amount) || 0),\n        );\n      }\n\n      const pName = o.product_name || \"Generic Product\";\n      productSales.set(pName, (productSales.get(pName) || 0) + 1);\n    });\n\n  const revenueData = Array.from(groupedRevenue.entries()).map(\n    ([name, revenue]) => ({ name, revenue }),\n  );\n  const topProducts = Array.from(productSales.entries())\n    .map(([name, sales]) => ({ name, sales }))\n    .sort((a, b) => b.sales - a.sales)\n    .slice(0, 5);\n\n  // Category Breakdown\n  const categoryRevenue = new Map<string, number>();\n  orders\n    .filter((o) => o.status !== \"cancelled\")\n    .forEach((o) => {\n      const cat = o.category || \"livestock\";\n      categoryRevenue.set(\n        cat,\n        (categoryRevenue.get(cat) || 0) + (Number(o.total_amount) || 0),\n      );\n    });\n  const categoryData = Array.from(categoryRevenue.entries()).map(\n    ([name, value]) => ({ name, value }),\n  );\n\n  // Wilaya distribution ΓÇö map Arabic name ΓåÆ numeric code using lookup table\n  const WILAYA_NAME_TO_ID: Record<string, string> = {\n    ╪ú╪»╪▒╪º╪▒: \"01\",\n    ╪º┘ä╪┤┘ä┘ü: \"02\",\n    ╪º┘ä╪ú╪║┘ê╪º╪╖: \"03\",\n    \"╪ú┘à ╪º┘ä╪¿┘ê╪º┘é┘è\": \"04\",\n    ╪¿╪º╪¬┘å╪⌐: \"05\",\n    ╪¿╪¼╪º┘è╪⌐: \"06\",\n    ╪¿╪│┘â╪▒╪⌐: \"07\",\n    ╪¿╪┤╪º╪▒: \"08\",\n    ╪º┘ä╪¿┘ä┘è╪»╪⌐: \"09\",\n    ╪º┘ä╪¿┘ê┘è╪▒╪⌐: \"10\",\n    ╪¬┘à┘å╪▒╪º╪│╪¬: \"11\",\n    ╪¬╪¿╪│╪⌐: \"12\",\n    ╪¬┘ä┘à╪│╪º┘å: \"13\",\n    ╪¬┘è╪º╪▒╪¬: \"14\",\n    \"╪¬┘è╪▓┘è ┘ê╪▓┘ê\": \"15\",\n    ╪º┘ä╪¼╪▓╪º╪ª╪▒: \"16\",\n    ╪º┘ä╪¼┘ä┘ü╪⌐: \"17\",\n    ╪¼┘è╪¼┘ä: \"18\",\n    ╪│╪╖┘è┘ü: \"19\",\n    ╪│╪╣┘è╪»╪⌐: \"20\",\n    ╪│┘â┘è┘â╪»╪⌐: \"21\",\n    \"╪│┘è╪»┘è ╪¿┘ä╪╣╪¿╪º╪│\": \"22\",\n    ╪╣┘å╪º╪¿╪⌐: \"23\",\n    ┘é╪º┘ä┘à╪⌐: \"24\",\n    ┘é╪│┘å╪╖┘è┘å╪⌐: \"25\",\n    ╪º┘ä┘à╪»┘è╪⌐: \"26\",\n    ┘à╪│╪¬╪║╪º┘å┘à: \"27\",\n    ╪º┘ä┘à╪│┘è┘ä╪⌐: \"28\",\n    ┘à╪╣╪│┘â╪▒: \"29\",\n    ┘ê╪▒┘é┘ä╪⌐: \"30\",\n    ┘ê┘ç╪▒╪º┘å: \"31\",\n    ╪º┘ä╪¿┘è╪╢: \"32\",\n    ╪Ñ┘ä┘è╪▓┘è: \"33\",\n    \"╪¿╪▒╪¼ ╪¿┘ê╪╣╪▒┘è╪▒┘è╪¼\": \"34\",\n    ╪¿┘ê┘à╪▒╪»╪º╪│: \"35\",\n    ╪º┘ä╪╖╪º╪▒┘ü: \"36\",\n    ╪¬┘å╪»┘ê┘ü: \"37\",\n    ╪¬┘è╪│┘à╪│┘è┘ä╪¬: \"38\",\n    ╪º┘ä┘ê╪º╪»┘è: \"39\",\n    ╪«┘å╪┤┘ä╪⌐: \"40\",\n    \"╪│┘ê┘é ╪ú┘ç╪▒╪º╪│\": \"41\",\n    ╪¬┘è╪¿╪º╪▓╪⌐: \"42\",\n    ┘à┘è┘ä╪⌐: \"43\",\n    \"╪╣┘è┘å ╪º┘ä╪»┘ü┘ä┘ë\": \"44\",\n    ╪º┘ä┘å╪╣╪º┘à╪⌐: \"45\",\n    \"╪╣┘è┘å ╪¬┘à┘ê╪┤┘å╪¬\": \"46\",\n    ╪║╪▒╪»╪º┘è╪⌐: \"47\",\n    ╪║┘ä┘è╪▓╪º┘å: \"48\",\n    ╪¬┘è┘à┘è┘à┘ê┘å: \"49\",\n    \"╪¿╪▒╪¼ ╪¿╪º╪¼┘è ┘à╪«╪¬╪º╪▒\": \"50\",\n    \"╪ú┘ê┘ä╪º╪» ╪¼┘ä╪º┘ä\": \"51\",\n    \"╪¿┘å┘è ╪╣╪¿╪º╪│\": \"52\",\n    \"╪╣┘è┘å ╪╡╪º┘ä╪¡\": \"53\",\n    \"╪╣┘è┘å ┘é╪▓╪º┘à\": \"54\",\n    ╪¬┘é╪▒╪¬: \"55\",\n    ╪¼╪º┘å╪¬: \"56\",\n    ╪º┘ä┘à╪║┘è╪▒: \"57\",\n    ╪º┘ä┘à┘å┘è╪╣╪⌐: \"58\",\n  };\n  const wilayaStats: Record<string, number> = {};\n  orders.forEach((o) => {\n    // wilaya_address stores \"detailedAddress, wilayaName\"\n    // o.wilaya_address comes from place_order: p_address + ', ' + p_wilaya\n    // Try to extract wilaya name from the end of wilaya_address\n    const rawWilaya = o.wilaya_address?.split(\",\").pop()?.trim() || \"\";\n    const wId = WILAYA_NAME_TO_ID[rawWilaya] || \"16\";\n    wilayaStats[wId] = (wilayaStats[wId] || 0) + 1;\n  });\n\n  // Alerts\n  const alerts: Alert[] = [];\n  if (lowStockItems.length > 0) {\n    // Choose \"┘à┘å╪¬╪¼╪º╪¬\" for 3-10, and \"┘à┘å╪¬╪¼╪º┘ï\" for 11-99\n    const itemName =\n      lowStockItems.length > 2 && lowStockItems.length <= 10\n        ? \"┘à┘å╪¬╪¼╪º╪¬\"\n        : \"┘à┘å╪¬╪¼╪º┘ï\";\n    alerts.push({\n      type: \"critical\",\n      message: `┘è┘ê╪¼╪» ${lowStockItems.length} ${itemName} ╪¿┘à╪«╪▓┘ê┘å ┘à┘å╪«┘ü╪╢`,\n      link: \"/inventory/breeds\",\n      label: \"┘å┘é╪╡ ╪º┘ä┘à╪«╪▓┘ê┘å\",\n    });\n  }\n\n  const pendingLong = orders.filter(\n    (o) =>\n      o.status === \"pending\" &&\n      o.created_at &&\n      new Date(o.created_at).getTime() < now - 86400000,\n  ).length;\n\n  if (pendingLong > 0) {\n    alerts.push({\n      type: \"warning\",\n      message: `${pendingLong} ╪╖┘ä╪¿ ┘à╪¬╪ú╪«╪▒ ┘è╪¡╪¬╪º╪¼ ┘ä┘ä┘à╪╣╪º┘ä╪¼╪⌐`,\n      link: \"/orders\",\n      label: \"╪╖┘ä╪¿┘è╪º╪¬ ┘à╪¬╪ú╪«╪▒╪⌐\",\n    });\n  }\n\n  // Forecasts\n  const forecasts: Forecast[] = [];\n  products.forEach((p) => {\n    const productOrdersCount = orders.filter(\n      (o) =>\n        (o.product_name === p.name_en || o.product_name === p.name) &&\n        o.created_at &&\n        new Date(o.created_at) > sevenDaysAgo,\n    ).length;\n    const dailyRate = productOrdersCount / 7;\n    if (dailyRate > 0) {\n      const daysLeft = Math.floor((p.stock || 0) / dailyRate);\n      if (daysLeft < 7) {\n        forecasts.push({\n          name: p.name_en || p.name || \"Unknown\",\n          daysLeft,\n          stock: p.stock,\n        });\n      }\n    }\n  });\n\n  const avgOrderValue =\n    orders.length > 0\n      ? Math.round(\n          revenue / orders.filter((o) => o.status !== \"cancelled\").length,\n        )\n      : 0;\n  const topBreedName = topProducts.length > 0 ? topProducts[0].name : \"N/A\";\n\n  // Compute real revenue & order change percentages (last 7d vs prior 7d)\n  const recentRevenue = recentOrders\n    .filter((o) => o.status !== \"cancelled\")\n    .reduce((sum, o) => sum + (Number(o.total_amount) || 0), 0);\n  const prevRevenue = prevPeriodOrders\n    .filter((o) => o.status !== \"cancelled\")\n    .reduce((sum, o) => sum + (Number(o.total_amount) || 0), 0);\n  const revenueChange =\n    prevRevenue > 0\n      ? Math.round(((recentRevenue - prevRevenue) / prevRevenue) * 100)\n      : recentRevenue > 0\n        ? 100\n        : 0;\n  const ordersChange =\n    prevPeriodOrders.length > 0\n      ? Math.round(\n          ((recentOrders.length - prevPeriodOrders.length) /\n            prevPeriodOrders.length) *\n            100,\n        )\n      : recentOrders.length > 0\n        ? 100\n        : 0;\n\n  const stats: DashboardStats = {\n    revenue,\n    activeOrders,\n    criticalStock: lowStockItems.length,\n    activeUniqueCustomers: uniqueCustomers.size,\n    totalCustomers,\n    avgOrderValue,\n    topBreed: topBreedName,\n    revenueChange,\n    ordersChange,\n  };\n\n  const analyticsData: AnalyticsData = {\n    revenueData,\n    topProducts,\n    categoryData,\n    wilayaData: wilayaStats,\n  };\n\n  return (\n    <div className=\"p-3 md:p-8 pb-10\">\n      <DashboardContent\n        stats={stats}\n        alerts={alerts}\n        forecasts={forecasts\n          .sort((a, b) => a.daysLeft - b.daysLeft)\n          .slice(0, 3)}\n        recentActivity={orders.slice(0, 10)}\n        analyticsData={analyticsData}\n      />\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Administrator\\Desktop\\my-online-shop\\admin-dashboard\\app\\(dashboard)\\products\\page.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\Administrator\\Desktop\\my-online-shop\\admin-dashboard\\app\\(dashboard)\\products\\page.tsx:73:5\n  71 |\n  72 |   useEffect(() => {\n> 73 |     fetchProducts();\n     |     ^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  74 |   }, [fetchProducts]);\n  75 |\n  76 |   // Handle Add/Edit Product","line":73,"column":5,"nodeType":null,"endLine":73,"endColumn":18}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\nimport { useEffect, useState, useCallback } from \"react\";\nimport { createClient } from \"@/utils/supabase/client\";\nimport { Database } from \"@/types/supabase\";\nimport { cn } from \"@/lib/utils\";\n\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { AnimatedButton } from \"@/components/ui/AnimatedButton\";\nimport Link from \"next/link\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Plus, Trash2, Edit, Save, X } from \"lucide-react\";\nimport { toast } from \"sonner\";\n\nimport { ConfirmDialog } from \"@/components/ui/ConfirmDialog\";\n\ntype Product = Database[\"public\"][\"Tables\"][\"products\"][\"Row\"];\ntype ProductInsert = Database[\"public\"][\"Tables\"][\"products\"][\"Insert\"];\n\ninterface ProductFormState {\n  name_en: string;\n  name_ar: string;\n  slug: string;\n  category: string;\n  subcategory: string;\n  price: string;\n  stock: string;\n  image_url: string;\n}\n\nexport default function ProductsPage() {\n  const supabase = createClient();\n  const [products, setProducts] = useState<Product[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [isAdding, setIsAdding] = useState(false);\n  const [editingId, setEditingId] = useState<string | null>(null);\n\n  // Confirmation Modal State\n  const [confirmOpen, setConfirmOpen] = useState(false);\n  const [deletingId, setDeletingId] = useState<string | null>(null);\n\n  // New Product Form State\n  const [newProduct, setNewProduct] = useState<ProductFormState>({\n    name_en: \"\",\n    name_ar: \"\",\n    slug: \"\",\n    category: \"eggs\",\n    subcategory: \"Australorp Family\",\n    price: \"\",\n    stock: \"\",\n    image_url: \"\",\n  });\n\n  // Fetch Products\n  const fetchProducts = useCallback(async (showLoader = true) => {\n    if (showLoader) setLoading(true);\n    const { data, error } = await (supabase as any)\n      .from(\"products\")\n      .select(\n        \"id, name_en, name, slug, category, subcategory, price, stock, image_url, deleted_at\",\n      )\n      .is(\"deleted_at\", null) // Only fetch active products\n      .order(\"created_at\", { ascending: false });\n\n    if (data) setProducts(data);\n    if (error) console.error(\"Error fetching products:\", error);\n    if (showLoader) setLoading(false);\n  }, [supabase]);\n\n  useEffect(() => {\n    fetchProducts();\n  }, [fetchProducts]);\n\n  // Handle Add/Edit Product\n  const handleSaveProduct = async (e: React.FormEvent) => {\n    e.preventDefault();\n    const finalSlug =\n      newProduct.slug ||\n      (newProduct.name_en || newProduct.name_ar)\n        .toLowerCase()\n        .replace(/[^a-z0-9\\u0600-\\u06FF]+/g, \"-\")\n        .replace(/(^-|-$)+/g, \"\") ||\n      `product-${new Date().getTime()}`;\n\n    const payload: ProductInsert = {\n      name: newProduct.name_ar,\n      name_en: newProduct.name_en,\n      slug: finalSlug,\n      category: newProduct.category,\n      subcategory: newProduct.subcategory,\n      price: Number(newProduct.price),\n      stock: Number(newProduct.stock),\n      image_url: newProduct.image_url || null,\n      is_active: true,\n    };\n\n    if (editingId) {\n      // Update existing product\n      const { error } = await supabase\n        .from(\"products\")\n        .update(payload)\n        .eq(\"id\", editingId);\n\n      if (error) {\n        toast.error(\"┘ü╪┤┘ä ╪¬╪¡╪»┘è╪½ ╪º┘ä┘à┘å╪¬╪¼: \" + error.message);\n        console.error(error);\n      } else {\n        toast.success(\"╪¬┘à ╪¬╪¡╪»┘è╪½ ╪º┘ä┘à┘å╪¬╪¼ ╪¿┘å╪¼╪º╪¡!\");\n        resetForm();\n        fetchProducts(false);\n      }\n    } else {\n      // Create new product\n      const { error } = await (supabase as any)\n        .from(\"products\")\n        .insert([payload]);\n\n      if (error) {\n        toast.error(\"┘ü╪┤┘ä ╪Ñ╪╢╪º┘ü╪⌐ ╪º┘ä┘à┘å╪¬╪¼: \" + error.message);\n        console.error(error);\n      } else {\n        toast.success(\"╪¬┘à╪¬ ╪Ñ╪╢╪º┘ü╪⌐ ╪º┘ä┘à┘å╪¬╪¼ ╪¿┘å╪¼╪º╪¡!\");\n        resetForm();\n        fetchProducts(false);\n      }\n    }\n  };\n\n  const handleEdit = (product: Product) => {\n    setEditingId(product.id);\n    setNewProduct({\n      name_en: product.name_en,\n      name_ar: product.name || \"\",\n      slug: product.slug || \"\",\n      category: product.category || \"eggs\",\n      subcategory: product.subcategory || \"\",\n      price: (product.price || 0).toString(),\n      stock: (product.stock || 0).toString(),\n      image_url: product.image_url || \"\",\n    });\n    setIsAdding(true);\n    // Scroll to form\n    window.scrollTo({ top: 0, behavior: \"smooth\" });\n  };\n\n  const handleDelete = async () => {\n    if (!deletingId) return;\n\n    const { error } = await supabase\n      .from(\"products\")\n      .update({ deleted_at: new Date().toISOString() })\n      .eq(\"id\", deletingId);\n\n    if (error) {\n      toast.error(\"┘ü╪┤┘ä ╪¡╪░┘ü ╪º┘ä┘à┘å╪¬╪¼: \" + error.message);\n      console.error(error);\n    } else {\n      toast.success(\"╪¬┘à ┘å┘é┘ä ╪º┘ä┘à┘å╪¬╪¼ ╪Ñ┘ä┘ë ╪│┘ä╪⌐ ╪º┘ä┘à╪¡╪░┘ê┘ü╪º╪¬\");\n      setProducts(products.filter((p) => p.id !== deletingId));\n    }\n    setConfirmOpen(false);\n    setDeletingId(null);\n  };\n\n  const resetForm = () => {\n    setIsAdding(false);\n    setEditingId(null);\n    setNewProduct({\n      name_en: \"\",\n      name_ar: \"\",\n      slug: \"\",\n      category: \"eggs\",\n      subcategory: \"Australorp Family\",\n      price: \"\",\n      stock: \"\",\n      image_url: \"\",\n    });\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      <ConfirmDialog\n        isOpen={confirmOpen}\n        onClose={() => {\n          setConfirmOpen(false);\n          setDeletingId(null);\n        }}\n        onConfirm={handleDelete}\n        title=\"┘å┘é┘ä ╪Ñ┘ä┘ë ╪│┘ä╪⌐ ╪º┘ä┘à╪¡╪░┘ê┘ü╪º╪¬╪ƒ\"\n        description=\"┘ç┘ä ╪ú┘å╪¬ ┘à╪¬╪ú┘â╪» ┘à┘å ┘å┘é┘ä ┘ç╪░╪º ╪º┘ä┘à┘å╪¬╪¼ ╪Ñ┘ä┘ë ╪│┘ä╪⌐ ╪º┘ä┘à╪¡╪░┘ê┘ü╪º╪¬╪ƒ ┘è┘à┘â┘å ╪º╪│╪¬╪╣╪º╪»╪¬┘ç ┘ä╪º╪¡┘é╪º┘ï.\"\n        confirmText=\"┘å┘é┘ä ┘ä┘ä╪│┘ä╪⌐\"\n        variant=\"destructive\"\n      />\n      <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6\">\n        <div>\n          <h1 className=\"text-4xl font-black tracking-tighter\">\n            ┘à╪»┘è╪▒ ╪º┘ä┘à╪«╪▓┘ê┘å ╪º┘ä╪┤╪º┘à┘ä\n          </h1>\n          <p className=\"text-muted-foreground font-black\">\n            ╪Ñ╪»╪º╪▒╪⌐ ╪¼┘à┘è╪╣ ┘à┘å╪¬╪¼╪º╪¬ ╪º┘ä┘à╪▓╪▒╪╣╪⌐ ┘ê╪¬╪¬╪¿╪╣ ┘à╪│╪¬┘ê┘è╪º╪¬ ╪º┘ä╪¬┘ê┘ü╪▒.\n          </p>\n        </div>\n        <div className=\"flex gap-3\">\n          <Link href=\"/products/recycle-bin\">\n            <AnimatedButton\n              variant=\"outline\"\n              className=\"rounded-xl h-12 bg-white dark:bg-card border-none shadow-md text-red-500 font-black\"\n            >\n              <Trash2 className=\"ms-2 h-4 w-4\" /> ╪│┘ä╪⌐ ╪º┘ä┘à╪¡╪░┘ê┘ü╪º╪¬\n            </AnimatedButton>\n          </Link>\n          {!isAdding && (\n            <AnimatedButton\n              onClick={() => setIsAdding(true)}\n              className=\"rounded-xl h-12 px-6 bg-emerald-600 text-white shadow-lg shadow-emerald-500/20 font-black\"\n            >\n              <Plus className=\"ms-2 h-5 w-5\" /> ╪Ñ╪╢╪º┘ü╪⌐ ┘à┘å╪¬╪¼\n            </AnimatedButton>\n          )}\n        </div>\n      </div>\n\n      {/* Add/Edit Product Form (Collapsible) */}\n      {isAdding && (\n        <Card\n          className={`border border-border/40 shadow-sm rounded-xl overflow-hidden ${editingId ? \"bg-blue-50/30 dark:bg-blue-950/10\" : \"bg-emerald-50/30 dark:bg-emerald-950/10\"}`}\n        >\n          <CardHeader className=\"flex flex-row items-center justify-between p-8\">\n            <CardTitle className=\"text-xl font-black\">\n              {editingId ? \"╪¬╪╣╪»┘è┘ä ╪º┘ä┘à┘å╪¬╪¼\" : \"╪Ñ╪╢╪º┘ü╪⌐ ┘à╪º╪»╪⌐ ╪¼╪»┘è╪»╪⌐\"}\n            </CardTitle>\n            <Button\n              variant=\"ghost\"\n              size=\"icon\"\n              onClick={resetForm}\n              className=\"rounded-xl\"\n            >\n              <X className=\"h-5 w-5\" />\n            </Button>\n          </CardHeader>\n          <CardContent className=\"p-8 pt-0\">\n            <form\n              onSubmit={handleSaveProduct}\n              className=\"grid gap-6 md:grid-cols-2\"\n            >\n              <div className=\"grid gap-2\">\n                <Label className=\"text-[10px] font-black uppercase tracking-widest text-muted-foreground me-1\">\n                  ╪º┘ä╪º╪│┘à ╪¿╪º┘ä╪Ñ┘å╪¼┘ä┘è╪▓┘è╪⌐\n                </Label>\n                <Input\n                  required\n                  placeholder=\"┘à╪½╪º┘ä: Brahma Gold\"\n                  value={newProduct.name_en}\n                  onChange={(e) => {\n                    const name = e.target.value;\n                    const slug = name\n                      .toLowerCase()\n                      .replace(/[^a-z0-9]+/g, \"-\")\n                      .replace(/(^-|-$)+/g, \"\");\n                    setNewProduct({ ...newProduct, name_en: name, slug: slug });\n                  }}\n                  className=\"h-12 rounded-xl bg-muted/50 border-none font-black\"\n                />\n              </div>\n              <div className=\"grid gap-2\">\n                <Label className=\"text-[10px] font-black uppercase tracking-widest text-muted-foreground me-1\">\n                  ╪º┘ä╪º╪│┘à ╪¿╪º┘ä╪╣╪▒╪¿┘è╪⌐\n                </Label>\n                <Input\n                  placeholder=\"┘à╪½╪º┘ä: ╪¿╪▒╪º┘ç┘à╪º ╪░┘ç╪¿┘è\"\n                  value={newProduct.name_ar}\n                  onChange={(e) =>\n                    setNewProduct({ ...newProduct, name_ar: e.target.value })\n                  }\n                  className=\"h-12 rounded-xl bg-muted/50 border-none font-black text-right\"\n                />\n              </div>\n\n              <div className=\"grid gap-2\">\n                <Label className=\"text-[10px] font-black uppercase tracking-widest text-muted-foreground me-1\">\n                  ╪º┘ä┘à╪╣╪▒┘ü ╪º┘ä╪¿╪▒┘à╪¼┘è (Slug)\n                </Label>\n                <Input\n                  placeholder=\"┘è╪¬┘à ╪¬┘ê┘ä┘è╪»┘ç ╪¬┘ä┘é╪º╪ª┘è╪º┘ï\"\n                  value={newProduct.slug}\n                  onChange={(e) =>\n                    setNewProduct({ ...newProduct, slug: e.target.value })\n                  }\n                  className=\"h-12 rounded-xl bg-muted/50 border-none font-mono text-sm\"\n                />\n              </div>\n\n              <div className=\"grid gap-2\">\n                <Label className=\"text-[10px] font-black uppercase tracking-widest text-muted-foreground me-1\">\n                  ╪º┘ä┘ü╪ª╪⌐ ╪º┘ä╪ú╪│╪º╪│┘è╪⌐\n                </Label>\n                <select\n                  className=\"flex h-12 w-full rounded-xl border-none bg-muted/50 px-4 py-2 text-sm font-black outline-none focus:ring-4 focus:ring-emerald-500/10 transition-all\"\n                  value={newProduct.category}\n                  onChange={(e) =>\n                    setNewProduct({ ...newProduct, category: e.target.value })\n                  }\n                >\n                  <option value=\"eggs\">╪¿┘è╪╢ ╪º┘ä╪¬┘ü┘é┘è╪│</option>\n                  <option value=\"chicks\">╪╡┘è╪╡╪º┘å</option>\n                  <option value=\"chickens\">╪»┘ê╪º╪¼┘å ╪¿╪º┘ä╪║╪⌐</option>\n                  <option value=\"machine\">╪¡╪º╪╢┘å╪º╪¬ ┘ê┘à╪╣╪»╪º╪¬</option>\n                </select>\n              </div>\n\n              <div className=\"grid gap-2\">\n                <Label className=\"text-[10px] font-black uppercase tracking-widest text-muted-foreground me-1\">\n                  ╪º┘ä┘ü╪ª╪⌐ ╪º┘ä┘ü╪▒╪╣┘è╪⌐\n                </Label>\n                <select\n                  className=\"flex h-12 w-full rounded-xl border-none bg-muted/50 px-4 py-2 text-sm font-black outline-none focus:ring-4 focus:ring-emerald-500/10 transition-all\"\n                  value={newProduct.subcategory}\n                  onChange={(e) =>\n                    setNewProduct({\n                      ...newProduct,\n                      subcategory: e.target.value,\n                    })\n                  }\n                >\n                  <option value=\"Australorp Family\">╪ú╪│╪¬╪▒╪º┘ä┘ê╪▒╪¿</option>\n                  <option value=\"Plymouth Rock Family\">╪¿┘ä┘è┘à┘ê╪½ ╪▒┘ê┘â</option>\n                  <option value=\"Brahma Family\">╪¿╪▒╪º┘ç┘à╪º</option>\n                  <option value=\"Sprite Family\">╪│╪¿╪▒┘è╪¬</option>\n                  <option value=\"Other Breeds\">╪│┘ä╪º┘ä╪º╪¬ ╪ú╪«╪▒┘ë</option>\n                  <option value=\"Incubator\">╪¡╪º╪╢┘å╪⌐</option>\n                </select>\n              </div>\n\n              <div className=\"grid gap-2\">\n                <Label className=\"text-[10px] font-black uppercase tracking-widest text-muted-foreground me-1\">\n                  ╪º┘ä╪│╪╣╪▒ (╪»╪¼)\n                </Label>\n                <Input\n                  required\n                  type=\"number\"\n                  placeholder=\"0\"\n                  value={newProduct.price}\n                  onChange={(e) =>\n                    setNewProduct({ ...newProduct, price: e.target.value })\n                  }\n                  className=\"h-12 rounded-xl bg-muted/50 border-none font-black\"\n                />\n              </div>\n\n              <div className=\"grid gap-2\">\n                <Label className=\"text-[10px] font-black uppercase tracking-widest text-muted-foreground me-1\">\n                  ┘â┘à┘è╪⌐ ╪º┘ä┘à╪«╪▓┘ê┘å\n                </Label>\n                <Input\n                  required\n                  type=\"number\"\n                  placeholder=\"0\"\n                  value={newProduct.stock}\n                  onChange={(e) =>\n                    setNewProduct({ ...newProduct, stock: e.target.value })\n                  }\n                  className=\"h-12 rounded-xl bg-muted/50 border-none font-black\"\n                />\n              </div>\n\n              <div className=\"col-span-2 flex gap-4 mt-4\">\n                <Button\n                  type=\"submit\"\n                  className=\"flex-1 h-14 rounded-xl bg-emerald-600 text-white shadow-sm font-black text-lg hover:bg-emerald-700\"\n                >\n                  {editingId ? \"╪¬╪╣╪»┘è┘ä ╪º┘ä╪¿┘è╪º┘å╪º╪¬\" : \"╪¡┘ü╪╕ ╪º┘ä┘à┘å╪¬╪¼ ╪º┘ä╪¼╪»┘è╪»\"}\n                </Button>\n                <Button\n                  type=\"button\"\n                  variant=\"outline\"\n                  onClick={resetForm}\n                  className=\"h-14 px-8 rounded-xl font-black\"\n                >\n                  ╪Ñ┘ä╪║╪º╪í\n                </Button>\n              </div>\n            </form>\n          </CardContent>\n        </Card>\n      )}\n\n      <Card className=\"border border-border/40 shadow-sm rounded-xl bg-white dark:bg-card overflow-hidden\">\n        <CardHeader className=\"p-8 pb-4\">\n          <CardTitle className=\"text-xl font-black\">\n            ╪º┘ä┘à╪«╪▓┘ê┘å ╪º┘ä╪¡╪º┘ä┘è ({products.length})\n          </CardTitle>\n        </CardHeader>\n        <CardContent className=\"px-0 sm:px-6\">\n          <div className=\"overflow-x-auto px-4 pb-4 sm:px-0 sm:pb-0\">\n            <table className=\"w-full text-sm text-right min-w-[800px]\">\n              <thead className=\"text-[10px] font-black uppercase tracking-[0.2em] text-muted-foreground bg-muted/30\">\n                <tr>\n                  <th className=\"px-8 py-4\">╪º┘ä┘à┘å╪¬╪¼</th>\n                  <th className=\"px-8 py-4\">╪º┘ä┘ü╪ª╪⌐</th>\n                  <th className=\"px-8 py-4\">╪º┘ä╪│╪╣╪▒ (╪»╪¼)</th>\n                  <th className=\"px-8 py-4 text-center\">╪º┘ä┘à╪«╪▓┘ê┘å</th>\n                  <th className=\"px-8 py-4 text-center\">╪º┘ä╪¡╪º┘ä╪⌐</th>\n                  <th className=\"px-8 py-4 text-left\">╪Ñ╪¼╪▒╪º╪í╪º╪¬</th>\n                </tr>\n              </thead>\n              <tbody>\n                {products.map((product) => (\n                  <tr\n                    key={product.id}\n                    className=\"bg-white border-b dark:bg-gray-800 dark:border-gray-700 hover:bg-emerald-50/30 transition-colors\"\n                  >\n                    <td className=\"px-6 py-4 font-black\">\n                      <div className=\"text-lg\">{product.name_en}</div>\n                      <div className=\"text-xs text-muted-foreground opacity-50 font-mono\">\n                        #{product.id.substring(0, 8)}\n                      </div>\n                    </td>\n                    <td className=\"px-8 py-5 capitalize\">\n                      <Badge\n                        variant=\"outline\"\n                        className=\"rounded-full px-3 py-1 border-emerald-200 dark:border-emerald-500/30 bg-emerald-50 dark:bg-emerald-500/10 text-emerald-600 font-black\"\n                      >\n                        {product.subcategory}\n                      </Badge>\n                    </td>\n                    <td className=\"px-8 py-5 font-black text-lg\">\n                      {product.price?.toLocaleString()}\n                    </td>\n                    <td className=\"px-8 py-5 text-center font-black\">\n                      <div\n                        className={cn(\n                          \"text-2xl font-black px-4 py-1.5 rounded-xl inline-block shadow-sm\",\n                          (product.stock ?? 0) < 10\n                            ? \"bg-red-50 dark:bg-red-500/10 text-red-600 border border-red-100\"\n                            : \"bg-emerald-50 dark:bg-emerald-500/10 text-emerald-600 border border-emerald-100 dark:border-emerald-500/20\",\n                        )}\n                      >\n                        {product.stock ?? 0}\n                      </div>\n                    </td>\n                    <td className=\"px-8 py-5 text-center\">\n                      <Badge\n                        className={cn(\n                          \"rounded-full px-3 py-1 font-black border-none\",\n                          (product.stock ?? 0) > 0\n                            ? \"bg-emerald-100 dark:bg-emerald-500/20 text-emerald-600\"\n                            : \"bg-red-100 dark:bg-red-500/20 text-red-600\",\n                        )}\n                      >\n                        {(product.stock ?? 0) > 0 ? \"┘à╪¬┘ê┘ü╪▒\" : \"╪¬┘å┘ü╪░\"}\n                      </Badge>\n                    </td>\n                    <td className=\"px-8 py-5 text-left\">\n                      <div className=\"flex gap-2\">\n                        <AnimatedButton\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          className=\"h-10 w-10 p-0 text-blue-500 hover:text-blue-600 hover:bg-blue-50 dark:bg-blue-500/10 rounded-xl\"\n                          onClick={() => handleEdit(product)}\n                        >\n                          <Edit className=\"h-4 w-4\" />\n                        </AnimatedButton>\n                        <AnimatedButton\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          className=\"h-10 w-10 p-0 text-red-500 hover:text-red-600 hover:bg-red-50 dark:bg-red-500/10 rounded-xl\"\n                          onClick={() => {\n                            setDeletingId(product.id);\n                            setConfirmOpen(true);\n                          }}\n                        >\n                          <Trash2 className=\"h-4 w-4\" />\n                        </AnimatedButton>\n                      </div>\n                    </td>\n                  </tr>\n                ))}\n                {products.length === 0 && !loading && (\n                  <tr>\n                    <td\n                      colSpan={6}\n                      className=\"px-8 py-20 text-center text-muted-foreground font-black opacity-30\"\n                    >\n                      ┘ä╪º ┘è┘ê╪¼╪» ┘à╪«╪▓┘ê┘å ╪¡╪º┘ä┘è╪º┘ï. ╪ú╪╢┘ü ╪¿╪╣╪╢ ╪º┘ä┘à┘å╪¬╪¼╪º╪¬ ┘ä┘ä╪¿╪»╪í!\n                    </td>\n                  </tr>\n                )}\n              </tbody>\n            </table>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","usedDeprecatedRules":[]}]
